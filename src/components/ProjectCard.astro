---
import type { CollectionEntry } from 'astro:content';
// 1. å¼•å…¥ Icon ç»„ä»¶
import { Icon } from 'astro-icon/components';

interface Props {
  project: CollectionEntry<'projects'>;
  useExternalLink?: boolean;
  // ğŸ‘‡ æ–°å¢çš„å¯é€‰å‚æ•°
  customTitle?: string;
  customDesc?: string;
  showExternalIcon?: boolean;
}

const { 
  project, 
  useExternalLink = false,
  customTitle,
  customDesc,
  showExternalIcon = false
} = Astro.props;

const href = useExternalLink ? project.data.url : `/projects/${project.slug}/`;
const target = useExternalLink ? '_blank' : '_self';

// ä¼˜å…ˆä½¿ç”¨ä¼ å…¥çš„è‡ªå®šä¹‰å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰åˆ™å›é€€åˆ° project åŸæ•°æ®
const displayTitle = customTitle || project.data.title;
const displayDesc = customDesc || project.data.description;
---

<a href={href} target={target} class="card project-card group">
  <div>
    <h4 class="card-title">
      {displayTitle}
    </h4>
    <p class="card-desc">{displayDesc}</p>
  </div>
  
  {showExternalIcon ? (
    // ğŸ…°ï¸ å˜ä½“æ¨¡å¼ï¼šæ˜¾ç¤ºé†’ç›®çš„å¤–é“¾å›¾æ ‡
    // name="mdi:open-in-new" æ˜¯ Material Design çš„å›¾æ ‡ï¼Œä½ å¯ä»¥æ¢æˆä½ å–œæ¬¢çš„
    <Icon name="mdi:open-in-new" class="big-icon" />
  ) : (
    // ğŸ…±ï¸ é»˜è®¤æ¨¡å¼ï¼šæ˜¾ç¤ºå¹´ä»½
    project.data.year && <span class="meta">[{project.data.year}]</span>
  )}
</a>

<style>
  .card {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    border: 1px solid #ccc;
    border-radius: 3px;
    text-decoration: none;
    color: inherit;
    transition: border-color 0.2s;
    padding: 1.5rem;
    height: 100%;
    box-sizing: border-box;
    position: relative; /* ä¸ºå›¾æ ‡å®šä½åšå‡†å¤‡ */
  }

  .card:hover {
    border-color: var(--link-color);
  }

  .card-title {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    font-weight: bold;
    color: var(--heading-color);
  }

  .card-desc {
    margin: 0;
    font-size: 0.95rem;
    color: var(--text-color);
    line-height: 1.5;
  }

  /* å¹´ä»½æ ·å¼ (ä¿æŒä¸å˜) */
  .meta {
    margin-top: 1rem;
    font-size: 0.85rem;
    font-family: monospace;
    color: #888;
    align-self: flex-end; 
  }

  /* ğŸ‘‡ æ–°å¢ï¼šå¤§å›¾æ ‡æ ·å¼ */
  .big-icon {
    font-size: 2rem; /* é†’ç›®çš„å¤§å°ºå¯¸ (32px) */
    color: #ccc;     /* é»˜è®¤ç°è‰²ï¼Œå¾ˆä½è°ƒ */
    align-self: flex-end; /* æ”¾åœ¨å³ä¸‹è§’ */
    margin-top: 1rem;
    transition: color 0.2s, transform 0.2s;
  }

  /* äº¤äº’ï¼šå½“å¡ç‰‡(çˆ¶å…ƒç´ )æ‚¬åœæ—¶ï¼Œå›¾æ ‡å˜è‰² */
  .card:hover .big-icon {
    color: var(--link-color); /* å˜æˆå“ç‰Œè‰² */
    transform: translate(2px, -2px); /* ç¨å¾®å¾€å³ä¸Šè§’åŠ¨ä¸€ä¸‹ï¼Œå¢åŠ ç‚¹å‡»è¯±å¯¼æ„Ÿ */
  }

  @media (prefers-color-scheme: dark) {
    .card { border-color: #444; }
    .big-icon { color: #555; } /* æš—é»‘æ¨¡å¼ä¸‹å›¾æ ‡é»˜è®¤æ·±ä¸€ç‚¹ */
  }
</style>